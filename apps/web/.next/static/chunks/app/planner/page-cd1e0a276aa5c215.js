(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[649],{1776:(e,s,t)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),!function(e,s){for(var t in s)Object.defineProperty(e,t,{enumerable:!0,get:s[t]})}(s,{default:function(){return d},getImageProps:function(){return n}});let a=t(5935),l=t(2596),r=t(2152),i=a._(t(5696));function n(e){let{props:s}=(0,l.getImgProps)(e,{defaultLoader:i.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,t]of Object.entries(s))void 0===t&&delete s[e];return{props:s}}let d=r.Image},4140:(e,s,t)=>{Promise.resolve().then(t.bind(t,9081))},4516:(e,s,t)=>{"use strict";let a;t.d(s,{TRPCReactProvider:()=>u,F:()=>x});var l=t(8831),r=t(714),i=t(5725),n=t(8655),d=t(311),o=t(8524),c=t(3833),m=t(4176);t(8476);let x=(0,n.pY)();function u(e){let s=(null!=a||(a=new c.E({defaultOptions:{queries:{staleTime:3e4},dehydrate:{serializeData:o.Ay.serialize,shouldDehydrateQuery:e=>(0,m.XS)(e)||"pending"===e.state.status},hydrate:{deserializeData:o.Ay.deserialize}}})),a),[t]=(0,d.useState)(()=>x.createClient({links:[(0,i.$H)({enabled:e=>"down"===e.direction&&e.result instanceof Error}),(0,i.N9)({transformer:o.Ay,url:window.location.origin+"/api/trpc",headers:()=>{let e=new Headers;return e.set("x-trpc-source","nextjs-react"),e}})]}));return(0,l.jsx)(r.Ht,{client:s,children:(0,l.jsx)(x.Provider,{client:t,queryClient:s,children:e.children})})}},9081:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>m});var a=t(8831),l=t(311),r=t(4516);function i(e){let{onComplete:s}=e,[t,r]=(0,l.useState)(2),[i,n]=(0,l.useState)(1),[d,o]=(0,l.useState)(7),[c,m]=(0,l.useState)(!1),[x,u]=(0,l.useState)(!1),[h,p]=(0,l.useState)("");return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900/50 p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-lg rounded-2xl bg-white p-8 shadow-xl",children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"Let's plan your week!"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:"Answer a few quick questions to get your personalised meal plan."}),(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),s({householdSize:t,mealsPerDay:i,days:d,isVegetarian:c,isDairyFree:x,dislikes:h})},className:"mt-8 space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"householdSize",className:"block text-sm font-semibold text-gray-900",children:"How many people?"}),(0,a.jsx)("select",{id:"householdSize",value:t,onChange:e=>r(Number(e.target.value)),className:"mt-2 block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition focus:border-emerald-600 focus:outline-none focus:ring-1 focus:ring-emerald-600",children:[1,2,3,4,5,6].map(e=>(0,a.jsxs)("option",{value:e,children:[e," ",1===e?"person":"people"]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"mealsPerDay",className:"block text-sm font-semibold text-gray-900",children:"How many meals per day?"}),(0,a.jsxs)("select",{id:"mealsPerDay",value:i,onChange:e=>n(Number(e.target.value)),className:"mt-2 block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition focus:border-emerald-600 focus:outline-none focus:ring-1 focus:ring-emerald-600",children:[(0,a.jsx)("option",{value:1,children:"1 meal (Dinner only)"}),(0,a.jsx)("option",{value:2,children:"2 meals (Lunch & Dinner)"}),(0,a.jsx)("option",{value:3,children:"3 meals (All meals)"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"days",className:"block text-sm font-semibold text-gray-900",children:"How many days to plan?"}),(0,a.jsx)("select",{id:"days",value:d,onChange:e=>o(Number(e.target.value)),className:"mt-2 block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition focus:border-emerald-600 focus:outline-none focus:ring-1 focus:ring-emerald-600",children:[3,4,5,6,7].map(e=>(0,a.jsxs)("option",{value:e,children:[e," days"]},e))})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-900",children:"Dietary preferences"}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"isVegetarian",checked:c,onChange:e=>m(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-emerald-600 transition focus:ring-2 focus:ring-emerald-600"}),(0,a.jsx)("label",{htmlFor:"isVegetarian",className:"text-sm text-gray-700",children:"Vegetarian"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("input",{type:"checkbox",id:"isDairyFree",checked:x,onChange:e=>u(e.target.checked),className:"h-4 w-4 rounded border-gray-300 text-emerald-600 transition focus:ring-2 focus:ring-emerald-600"}),(0,a.jsx)("label",{htmlFor:"isDairyFree",className:"text-sm text-gray-700",children:"Dairy-free"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"dislikes",className:"block text-sm font-semibold text-gray-900",children:"Foods to avoid (optional)"}),(0,a.jsx)("input",{type:"text",id:"dislikes",value:h,onChange:e=>p(e.target.value),placeholder:"e.g., mushrooms, olives",className:"mt-2 block w-full rounded-lg border border-gray-300 bg-white px-4 py-3 text-gray-900 shadow-sm transition focus:border-emerald-600 focus:outline-none focus:ring-1 focus:ring-emerald-600"}),(0,a.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Separate multiple items with commas"})]}),(0,a.jsx)("button",{type:"submit",className:"w-full rounded-full bg-emerald-600 px-8 py-3 text-base font-semibold text-white shadow-sm transition hover:bg-emerald-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600",children:"Create My Plan"})]})]})})}let n=JSON.parse('[{"name":"Lidl","total":42.6,"savings":0,"isCheapest":true},{"name":"Tesco","total":47.8,"savings":-5.2,"isCheapest":false},{"name":"Dunnes","total":45.3,"savings":-2.7,"isCheapest":false},{"name":"SuperValu","total":48.5,"savings":-5.9,"isCheapest":false}]');function d(e){var s,t;let{onClose:l}=e,r=n.find(e=>e.isCheapest);return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-gray-900/50 p-4",children:(0,a.jsxs)("div",{className:"w-full max-w-2xl rounded-2xl bg-white p-8 shadow-xl",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"Price Comparison"}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-600",children:"See which supermarket offers the best value for your shopping list"})]}),(0,a.jsx)("button",{onClick:l,className:"rounded-lg p-2 text-gray-400 transition hover:bg-gray-100 hover:text-gray-600","aria-label":"Close modal",children:(0,a.jsx)("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,a.jsxs)("div",{className:"mt-6 inline-flex items-center gap-2 rounded-full bg-emerald-100 px-4 py-2 text-sm font-semibold text-emerald-700",children:[(0,a.jsx)("span",{children:"✨"}),(0,a.jsx)("span",{children:"Premium Feature Preview"})]}),(0,a.jsx)("div",{className:"mt-6 overflow-hidden rounded-xl border border-gray-200",children:(0,a.jsxs)("table",{className:"w-full",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsxs)("tr",{children:[(0,a.jsx)("th",{className:"px-6 py-3 text-left text-sm font-semibold text-gray-900",children:"Store"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-900",children:"Total"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right text-sm font-semibold text-gray-900",children:"Estimated Savings"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-gray-200 bg-white",children:n.map(e=>(0,a.jsxs)("tr",{className:e.isCheapest?"bg-emerald-50":"",children:[(0,a.jsx)("td",{className:"px-6 py-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-900",children:e.name}),e.isCheapest&&(0,a.jsx)("span",{className:"rounded-full bg-emerald-600 px-2 py-0.5 text-xs font-semibold text-white",children:"Best Value"})]})}),(0,a.jsxs)("td",{className:"px-6 py-4 text-right text-sm font-semibold text-gray-900",children:["€",e.total.toFixed(2)]}),(0,a.jsx)("td",{className:"px-6 py-4 text-right text-sm",children:0===e.savings?(0,a.jsx)("span",{className:"text-gray-500",children:"—"}):(0,a.jsxs)("span",{className:"font-semibold text-red-600",children:["€",e.savings.toFixed(2)]})})]},e.name))})]})}),(0,a.jsx)("div",{className:"mt-6 rounded-lg bg-emerald-50 p-4",children:(0,a.jsxs)("p",{className:"text-sm text-emerald-900",children:["\uD83D\uDCA1 ",(0,a.jsx)("strong",{children:"With Premium:"})," Shop at ",null==r?void 0:r.name," this week and save up to"," ","€",Math.abs(null!=(t=null==(s=n[n.length-1])?void 0:s.savings)?t:0).toFixed(2)," compared to other stores!"]})}),(0,a.jsxs)("div",{className:"mt-8 space-y-3",children:[(0,a.jsx)("button",{onClick:l,className:"w-full rounded-full bg-emerald-600 px-8 py-3 text-base font-semibold text-white shadow-sm transition hover:bg-emerald-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600",children:"Upgrade to Unlock Real Comparisons"}),(0,a.jsx)("p",{className:"text-center text-xs text-gray-500",children:"Prototype pricing only • Real prices available with Premium subscription"})]})]})})}var o=t(1776),c=t.n(o);function m(){let[e,s]=(0,l.useState)("wizard"),[t,n]=(0,l.useState)(null),[o,m]=(0,l.useState)(null),[x,u]=(0,l.useState)(!1),h=r.F.mealPlan.generate.useMutation({onSuccess:e=>{n(e.id),s("plan")}}),{data:p}=r.F.mealPlan.getCurrent.useQuery(void 0,{enabled:"plan"===e&&null!==t}),{data:g}=r.F.shoppingList.getForMealPlan.useQuery({mealPlanId:t},{enabled:"shopping"===e&&null!==t});return(0,a.jsxs)("main",{className:"min-h-screen",children:["wizard"===e&&(0,a.jsx)(i,{onComplete:e=>{m(e),h.mutate(e)}}),h.isPending&&(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"mb-4 inline-block h-12 w-12 animate-spin rounded-full border-4 border-solid border-emerald-600 border-r-transparent"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-900",children:"Creating your meal plan..."})]})}),h.isError&&(0,a.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 px-6",children:(0,a.jsxs)("div",{className:"max-w-md rounded-xl bg-white p-8 text-center shadow-lg",children:[(0,a.jsx)("p",{className:"text-lg font-semibold text-red-600",children:"Failed to generate meal plan"}),(0,a.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:h.error.message}),(0,a.jsx)("button",{onClick:()=>s("wizard"),className:"mt-6 rounded-full bg-emerald-600 px-6 py-2 text-sm font-semibold text-white hover:bg-emerald-700",children:"Try Again"})]})}),"plan"===e&&p&&o&&(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,a.jsxs)("div",{className:"mx-auto max-w-7xl px-6",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-gray-900 sm:text-4xl",children:"Your Weekly Meal Plan"}),(0,a.jsxs)("p",{className:"mt-2 text-base text-gray-600",children:[o.days," days \xb7 ",o.mealsPerDay," ",1===o.mealsPerDay?"meal":"meals","/day \xb7 ",o.householdSize," ",1===o.householdSize?"person":"people"]}),(0,a.jsxs)("div",{className:"mt-4 inline-flex flex-wrap items-center gap-2",children:[o.isVegetarian&&(0,a.jsx)("span",{className:"rounded-full bg-emerald-100 px-4 py-2 text-sm font-semibold text-emerald-700",children:"\uD83C\uDF31 Vegetarian"}),o.isDairyFree&&(0,a.jsx)("span",{className:"rounded-full bg-blue-100 px-4 py-2 text-sm font-semibold text-blue-700",children:"\uD83E\uDD5B Dairy-free"})]})]}),(0,a.jsx)("div",{className:"grid gap-6 sm:grid-cols-2 lg:grid-cols-3",children:p.items.map(e=>(0,a.jsxs)("div",{className:"group overflow-hidden rounded-xl bg-white shadow-sm ring-1 ring-gray-200 transition hover:shadow-md",children:[(0,a.jsxs)("div",{className:"relative aspect-[4/3] overflow-hidden bg-gray-200",children:[e.recipe.imageUrl&&(0,a.jsx)(c(),{src:e.recipe.imageUrl,alt:e.recipe.title,fill:!0,className:"object-cover transition group-hover:scale-105"}),(0,a.jsxs)("div",{className:"absolute left-3 top-3 rounded-full bg-white/90 px-3 py-1 text-xs font-semibold text-gray-900 backdrop-blur-sm",children:["Day ",e.dayIndex+1," \xb7 ",e.mealType]})]}),(0,a.jsxs)("div",{className:"p-4",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.recipe.title}),(0,a.jsxs)("div",{className:"mt-3 flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"⏱️"}),(0,a.jsxs)("span",{children:[e.recipe.minutes," min"]})]}),(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)("span",{children:"\uD83D\uDD25"}),(0,a.jsxs)("span",{children:[e.recipe.calories," kcal"]})]})]})]})]},e.id))}),(0,a.jsx)("div",{className:"mt-12 text-center",children:(0,a.jsx)("button",{onClick:()=>{s("shopping")},className:"rounded-full bg-emerald-600 px-8 py-3 text-base font-semibold text-white shadow-sm transition hover:bg-emerald-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600",children:"View Shopping List"})})]})}),"shopping"===e&&g&&(0,a.jsx)("div",{className:"min-h-screen bg-gray-50 py-12",children:(0,a.jsxs)("div",{className:"mx-auto max-w-5xl px-6",children:[(0,a.jsxs)("div",{className:"mb-8 text-center",children:[(0,a.jsx)("h1",{className:"text-3xl font-semibold text-gray-900 sm:text-4xl",children:"Your Shopping List"}),(0,a.jsxs)("p",{className:"mt-2 text-base text-gray-600",children:[g.totalItems," items for your meal plan"]})]}),(0,a.jsx)("div",{className:"space-y-6",children:Object.entries(g.grouped).map(e=>{let[s,t]=e;return(0,a.jsxs)("div",{className:"rounded-xl bg-white p-6 shadow-sm ring-1 ring-gray-200",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold capitalize text-gray-900",children:s}),(0,a.jsx)("ul",{className:"mt-4 space-y-3",children:t.map(e=>(0,a.jsxs)("li",{className:"flex items-center gap-3",children:[(0,a.jsx)("span",{className:"h-5 w-5 flex-shrink-0 text-emerald-600",children:"✓"}),(0,a.jsxs)("span",{className:"flex-1 text-sm text-gray-700",children:[e.ingredientName," - ",e.formattedQuantity]})]},e.ingredientId))})]},s)})}),g.cheapestStore&&(0,a.jsxs)("div",{className:"mt-8 rounded-xl bg-emerald-50 p-6 ring-1 ring-emerald-200",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Price Estimate"}),(0,a.jsxs)("p",{className:"mt-2 text-2xl font-bold text-emerald-600",children:["€",g.cheapestStore.totalPrice.toFixed(2)]}),(0,a.jsxs)("p",{className:"mt-1 text-sm text-gray-600",children:["Estimated total at ",g.cheapestStore.store]}),(0,a.jsx)("div",{className:"mt-4 space-y-2",children:g.storePrices.map(e=>(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{className:"text-gray-700",children:e.store}),(0,a.jsxs)("span",{className:"font-semibold text-gray-900",children:["€",e.totalPrice.toFixed(2)]})]},e.store))})]}),(0,a.jsxs)("div",{className:"mt-12 flex justify-center gap-4",children:[(0,a.jsx)("button",{onClick:()=>{if(!t)return;let e="/api/trpc/shoppingList.exportCSV?input=".concat(encodeURIComponent(JSON.stringify({mealPlanId:t})));window.open(e,"_blank")},className:"rounded-full border border-gray-300 bg-white px-8 py-3 text-base font-semibold text-gray-900 shadow-sm transition hover:bg-gray-50",children:"Export CSV"}),(0,a.jsx)("button",{onClick:()=>{u(!0)},className:"rounded-full bg-emerald-600 px-8 py-3 text-base font-semibold text-white shadow-sm transition hover:bg-emerald-700 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-emerald-600",children:"Compare Prices (Premium)"})]})]})}),x&&(0,a.jsx)(d,{onClose:()=>{u(!1)}})]})}}},e=>{e.O(0,[11,152,677,851,358],()=>e(e.s=4140)),_N_E=e.O()}]);